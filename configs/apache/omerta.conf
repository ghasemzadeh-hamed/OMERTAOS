<VirtualHost *:80>
    ServerName omerta.example.com

    ProxyPreserveHost On
    ProxyRequests Off

    ProxyPass        /  http://127.0.0.1:3000/
    ProxyPassReverse /  http://127.0.0.1:3000/

    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://127.0.0.1:3000/$1 [P,L]

    ErrorLog ${APACHE_LOG_DIR}/omerta_error.log
    CustomLog ${APACHE_LOG_DIR}/omerta_access.log combined
</VirtualHost>
